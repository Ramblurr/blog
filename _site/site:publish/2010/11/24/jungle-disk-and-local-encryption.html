<!DOCTYPE html>
<head profile="http://gmpg.org/xfn/11">
    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <link rel="openid.delegate"  href="http://rmblr.myopenid.com/" />
    <link rel="openid2.local_id" href="http://rmblr.myopenid.com" />
    <link rel="openid2.provider" href="http://www.myopenid.com/server" />
    <meta http-equiv="X-XRDS-Location"  content="http://www.myopenid.com/xrds?username=rmblr.myopenid.com" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>Jungle Disk & Local Encryption </title>

    <link rel="stylesheet" type="text/css" href="/blog/css/homepage.css">
    <link rel="stylesheet" type="text/css" href="/blog/css/blog.css">
    <link rel="stylesheet" type="text/css" href="/blog/css/post_specific.css">
    <link rel="stylesheet" href="/blog/css/textboxes.css" type="text/css" media="screen, projection" />

<script type="text/javascript">

  var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-22027971-1']);
  _gaq.push(['_setDomainName', '.binaryelysium.com']);
    _gaq.push(['_trackPageview']);

  (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl'
      : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();

</script>

</head>

<div class="top">
<div class="body">
<h1><a href="http://binaryelysium.com/blog" title="Binary Elysium - Blog">Binary Elysium</a></h1>

<div class="translucent">
<div class="summary">
Hey there! My name is Casey. I'm a software developer, nomad, language lover, and coffee fiend.
</div>
</div>

<div class="content">

    <div class="post">
                <h2><a href="http://binaryelysium.com/blog/2010/11/24/jungle-disk-and-local-encryption.html" rel="bookmark" title="Permanent Link to Jungle Disk & Local Encryption">
                    Jungle Disk & Local Encryption
                    </a></h2>
                <p class="small">
                         24 November 2010
                </p>

                <div class="entry">
                    <p>For the past several years I have used <a href="https://s3.amazonaws.com/">Amazon S3</a> in conjunction with <a href="http://www.jungledisk.com/">Jungle Disk</a> to perform painless online backups. Luckily, I jumped on the Jungle Disk bandwagon back when they offered a &ldquo;Lifetime&rdquo; pricing option which cost $20. In 2008 when they introduced the Plus service, which enabled web access, incremental changes, and upload resume for $1/mo, I jumped on it and have been a Plus subscriber ever since.</p>

<p>Why do I prefer Jungle Disk over the many other <a href="http://en.wikipedia.org/wiki/Comparison_of_online_backup_services" title="Comparison of online backup services">online other backup tools</a>? It is rather simple: I own my data. With Jungle Disk, my data is stored on S3 buckets associated with <em>my</em> Amazon AWS credentials. Moreover, Jungle Disk has released an <a href="http://downloads.jungledisk.com/jungledisk/JungleDiskSourceExample.zip" title="Jungle Disk Source Example">example open source client</a> that can be used to download and decrypt data uploaded and ecrypted with Jungle Disk.</p>

<p>Sure, I could rig up a commensurate system for free using <a href="http://code.google.com/p/s3fs/" title="s3fs: FUSE-based file system backed by Amazon S3">s3fs</a> and rsync. However, I would rather save my valuable time and rely on the experts at Jungle Disk whose livelihood is making this software work, and work well.</p>

<p>Jungle Disk has a Drop Box-esque feature called <a href="http://support.jungledisk.com/forums/61795/entries/74380" title="Jungle Disk: Sync Folders">Sync Folders</a> which allows you to keep a local folder synchronized with a folder on your network drive. I use this feature heavily to keep work and school files synced between my laptop and desktop.</p>

<p>My one gripe with Sync Folders is that it does not encrypt locally stored data. I would like a solution whereby locally stored data is encrypted, yet Jungle Disk can still backup and sync the decrypted data.</p>

<p>For unrelated reasons I prefer <a href="http://www.arg0.net/encfs" title=" EncFS Encrypted Filesystem">encfs</a> over Truecrypt, so I devised a solution that decrypts an encfs filesystem to a mount point that Jungle Disk is set to use, though it can be modified to accommodate Truecrypt. For this to function properly the encfs fs must be decrypted and mounted before Jungle Disk is started, else Jungle Disk will begin cheerfully downloading the remote data into the empty mount point.</p>

<p>Here is the bash script that does just that. It uses kdialog to prompt for the encryption key, then attempts to decrypt and mount the fs, and if successful starts Jungle Disk. I added it as a script to Autostart in KDE&rsquo;s system settings.</p>

<div class="highlight"><pre><code class="bash"><span class="c">#!/bin/bash</span>

<span class="c">## Config ##</span>

<span class="nv">JD</span><span class="o">=</span><span class="nv">$HOME</span>/bin/junglediskdesktop/junglediskdesktop

<span class="nv">ENCFS</span><span class="o">=</span>/usr/bin/encfs
<span class="nv">ENCFS_ROOTDIR</span><span class="o">=</span><span class="nv">$HOME</span>/docs/.private/
<span class="nv">ENCFS_MNTPOINT</span><span class="o">=</span><span class="nv">$HOME</span>/docs/private_enc

<span class="nv">DIALOG</span><span class="o">=</span>/usr/bin/kdialog
<span class="c">#DIALOG=/usr/bin/Xdialog</span>
<span class="c">#DIALOG=/usr/bin/zenity</span>

<span class="c">## Do not edit below ##</span>

<span class="nv">KEY</span><span class="o">=</span><span class="k">$(</span><span class="nv">$DIALOG</span> --title <span class="s2">&quot;Start Encrypted Jungle Disk&quot;</span> --password <span class="s2">&quot;Input key to decrypt $ENCFS_ROOTDIR. Jungle Disk will be started following a successful mount.&quot;</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> !<span class="o">=</span> 0 <span class="o">]</span>; <span class="k">then</span>
  <span class="c"># user pressed cancel</span>
  <span class="nb">exit</span>
<span class="k">fi</span>

<span class="nb">echo</span> <span class="nv">$KEY</span> | <span class="nv">$ENCFS</span> --stdinpass <span class="nv">$ENCFS_ROOTDIR</span> <span class="nv">$ENCFS_MNTPOINT</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> !<span class="o">=</span> 0 <span class="o">]</span>; <span class="k">then</span>
  <span class="nv">$DIALOG</span> --title <span class="s2">&quot;Mount Failed&quot;</span> --msgbox <span class="s2">&quot;The mount of $ENCFS_MNTPOINT failed. Aborting Jungle Disk start.&quot;</span> 0x0
  <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c">#start JD</span>

<span class="nv">$JD</span> &amp;
</code></pre>
</div>




                </div>

        </div> <!-- /post -->
<h2>Recent Posts</h2>
<ul class="posts">
    
    <li><span>13 Dec 2011</span> &raquo; <a href="http://binaryelysium.com/blog/2011/12/13/a-reluctant-relationship-yubikey-google-authentication.html">A Reluctant Relationship: Yubikey and Google Authentication</a></li>
    
    <li><span>12 Mar 2011</span> &raquo; <a href="http://binaryelysium.com/blog/2011/03/12/pbm-is-dead.html">PBM is dead! Long live PBM!</a></li>
    
    <li><span>24 Nov 2010</span> &raquo; <a href="http://binaryelysium.com/blog/2010/11/24/jungle-disk-and-local-encryption.html">Jungle Disk & Local Encryption</a></li>
    
      <li><a href="http://binaryelysium.com/blog/" title="Binary Elysium - Blog">Older posts</a></li>
  </ul>


<p><a href="/" title="Binary Elysium">&larr; More Awesome Stuff</a></p>
</div> <!--- content -->
<div class="bottom">
<div class="content">


</div>
</div>

<address class="tip">
    <p>binaryelysium.com <span>&middot; page layout by <a href="http://inamidst.com/" title="In amidst">Sean Palmer</a><br />&middot;header image by <a href="http://cloaks.deviantart.com/art/Elysium-Texture-Pack-173766346">cloaks</a></span></p>



